
   FAIL  Tests\Feature\SubscriptionTest
  âœ“ guest cannot access subscription create                              0.13s  
  â¨¯ free user can access subscription create                             0.27s  
  â¨¯ premium user cannot access subscription create                       1.04s  
  â¨¯ admin cannot access subscription create                              0.02s  
  âœ“ guest cannot access subscription store                               0.01s  
  â¨¯ free user can access subscription store                              0.15s  
  â¨¯ premium user cannot access subscription store                        0.80s  
  â¨¯ admin cannot access subscription store                               0.03s  
  âœ“ guest cannot access subscription edit                                0.01s  
  â¨¯ free user cannot access subscription edit                            0.17s  
  â¨¯ premium user can access subscription edit                            0.40s  
  â¨¯ admin cannot access subscription edit                                0.03s  
  âœ“ guest cannot access subscription update                              0.01s  
  â¨¯ free user cannot access subscription update                          0.17s  
  â¨¯ premium user can access subscription update                          0.32s  
  â¨¯ admin cannot access subscription update                              0.03s  
  âœ“ guest cannot access subscription cancel                              0.01s  
  â¨¯ free user cannot access subscription cancel                          0.17s  
  â¨¯ premium user can access subscription cancel                          0.37s  
  â¨¯ admin cannot access subscription cancel                              0.03s  
  âœ“ guest cannot access subscription destroy                             0.02s  
  â¨¯ free user cannot access subscription destroy                         0.17s  
  â¨¯ premium user can access subscription destroy                         0.40s  
  â¨¯ admin cannot access subscription destroy                             0.03s  
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user can access subscriptioâ€¦   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/NotSubscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\NotSubscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(27): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_can_access_subscription_create()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 25 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/NotSubscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\NotSubscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(27): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_can_access_subscription_create()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 25 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:29
     25â–•          $user = User::factory()->create();
     26â–• 
     27â–•          $response = $this->actingAs($user)->get(route('subscription.create'));
     28â–• 
  âžœ  29â–•          $response->assertStatus(200);
     30â–•      }
     31â–• 
     32â–•      // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®æœ‰æ–™ä¼šå“¡ã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ç™»éŒ²ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„
     33â–•      public function test_premium_user_cannot_access_subscription_create()

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W6xQPHBounsF, `users`.`updated_at` = 2024-10-27 08:07:09 where `id` = 26)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:36

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$w9JdDmGJRybxxuu2HuIMg.RGNtJdQY/tn1TN5WYvkUytnnAleXdZO, 2024-10-27 08:07:09, 2024-10-27 08:07:09))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:49

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user can access subscriptioâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/NotSubscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\NotSubscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(375): Illuminate\Foundation\Testing\TestCase->call('POST', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(77): Illuminate\Foundation\Testing\TestCase->post('http://localhos...', Array)
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_can_access_subscription_store()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 27 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/NotSubscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\NotSubscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(375): Illuminate\Foundation\Testing\TestCase->call('POST', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(77): Illuminate\Foundation\Testing\TestCase->post('http://localhos...', Array)
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_can_access_subscription_store()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 27 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:79
     75â–•          ];
     76â–• 
     77â–•          $response = $this->actingAs($user)->post(route('subscription.store'), $request_parameter);
     78â–• 
  âžœ  79â–•          $response->assertRedirect(route('home'));
     80â–• 
     81â–•          $user->refresh();
     82â–•          $this->assertTrue($user->subscribed('premium_plan'));
     83â–•      }

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W6yKLYbc9fqk, `users`.`updated_at` = 2024-10-27 08:07:10 where `id` = 28)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:89

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$iarbGop82eSLqGEyNxl2Ce2tTEVfwjjZizYyHH11g0xwnzdNK2Bmm, 2024-10-27 08:07:10, 2024-10-27 08:07:10))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:106

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user cannot access subscripâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(130): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_edit()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 29 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(130): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_edit()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 29 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:132
    128â–•          $user = User::factory()->create();
    129â–• 
    130â–•          $response = $this->actingAs($user)->get(route('subscription.edit'));
    131â–• 
  âžœ 132â–•          $response->assertRedirect(route('subscription.create'));
    133â–•      }
    134â–• 
    135â–•      // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®æœ‰æ–™ä¼šå“¡ã¯ãŠæ”¯æ‰•ã„æ–¹æ³•ç·¨é›†ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
    136â–•      public function test_premium_user_can_access_subscription_edit()

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W6cL6ZOgBUnm, `users`.`updated_at` = 2024-10-27 08:07:11 where `id` = 30)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:139

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$gf60tBpvDYw2iDsp3ipfwuYkt8i49fHvaluwz1QC3erGLiYgO1c8K, 2024-10-27 08:07:11, 2024-10-27 08:07:11))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:152

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user cannot access subscripâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(435): Illuminate\Foundation\Testing\TestCase->call('PATCH', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(180): Illuminate\Foundation\Testing\TestCase->patch('http://localhos...', Array)
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_update()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 31 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(435): Illuminate\Foundation\Testing\TestCase->call('PATCH', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(180): Illuminate\Foundation\Testing\TestCase->patch('http://localhos...', Array)
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_update()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 31 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:182
    178â–•          ];
    179â–• 
    180â–•          $response = $this->actingAs($user)->patch(route('subscription.update'), $request_parameter);
    181â–• 
  âžœ 182â–•          $response->assertRedirect(route('subscription.create'));
    183â–•      }
    184â–• 
    185â–•      // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®æœ‰æ–™ä¼šå“¡ã¯ãŠæ”¯æ‰•ã„æ–¹æ³•ã‚’æ›´æ–°ã§ãã‚‹
    186â–•      public function test_premium_user_can_access_subscription_update()

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W6dPR9xenhjW, `users`.`updated_at` = 2024-10-27 08:07:11 where `id` = 32)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:189

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$gi63heGkwJPFgoHhKfo/HuePsrC/fR4yWxcLygPcFWylS4UtCX/1W, 2024-10-27 08:07:11, 2024-10-27 08:07:11))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:211

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user cannot access subscripâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(235): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_cancel()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 33 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(346): Illuminate\Foundation\Testing\TestCase->call('GET', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(235): Illuminate\Foundation\Testing\TestCase->get('http://localhos...')
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_cancel()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 33 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:237
    233â–•          $user = User::factory()->create();
    234â–• 
    235â–•          $response = $this->actingAs($user)->get(route('subscription.cancel'));
    236â–• 
  âžœ 237â–•          $response->assertRedirect(route('subscription.create'));
    238â–•      }
    239â–• 
    240â–•      // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®æœ‰æ–™ä¼šå“¡ã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³è§£ç´„ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
    241â–•      public function test_premium_user_can_access_subscription_cancel()

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W6tlCZ5sj6MX, `users`.`updated_at` = 2024-10-27 08:07:12 where `id` = 34)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:244

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$vHfjq9hdMOQe7B/PKw4PROzON67MpEo0mU0wRyVhL/Nvs9MIsqTg2, 2024-10-27 08:07:12, 2024-10-27 08:07:12))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:257

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > free user cannot access subscripâ€¦   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 500.
Failed asserting that false is true.

The following exception occurred during the last request:

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:423
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(423): PDO->prepare('select * from `...')
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(816): Illuminate\Database\Connection->Illuminate\Database\{closure}('select * from `...', Array)
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(465): Illuminate\Foundation\Testing\TestCase->call('DELETE', 'http://localhos...', Array, Array, Array, Array)
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(277): Illuminate\Foundation\Testing\TestCase->delete('http://localhos...')
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_destroy()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#70 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#71 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#72 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 35 and `subscriptions`.`user_id` is not null order by `created_at` desc) in /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
Stack trace:
#0 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(783): Illuminate\Database\Connection->runQueryCallback('select * from `...', Array, Object(Closure))
#1 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Connection.php(414): Illuminate\Database\Connection->run('select * from `...', Array, Object(Closure))
#2 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2913): Illuminate\Database\Connection->select('select * from `...', Array, true)
#3 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2902): Illuminate\Database\Query\Builder->runSelect()
#4 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(3456): Illuminate\Database\Query\Builder->Illuminate\Database\Query\{closure}()
#5 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Query/Builder.php(2901): Illuminate\Database\Query\Builder->onceWithColumns(Array, Object(Closure))
#6 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(739): Illuminate\Database\Query\Builder->get(Array)
#7 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Builder.php(723): Illuminate\Database\Eloquent\Builder->getModels(Array)
#8 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Relations/HasMany.php(32): Illuminate\Database\Eloquent\Builder->get()
#9 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(591): Illuminate\Database\Eloquent\Relations\HasMany->getResults()
#10 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(529): Illuminate\Database\Eloquent\Model->getRelationshipFromMethod('subscriptions')
#11 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php(454): Illuminate\Database\Eloquent\Model->getRelationValue('subscriptions')
#12 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php(2227): Illuminate\Database\Eloquent\Model->getAttribute('subscriptions')
#13 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(155): Illuminate\Database\Eloquent\Model->__get('subscriptions')
#14 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/cashier/src/Concerns/ManagesSubscriptions.php(138): App\Models\User->subscription('premium_plan')
#15 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/Subscribed.php(18): App\Models\User->subscribed('premium_plan')
#16 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\Subscribed->handle(Object(Illuminate\Http\Request), Object(Closure))
#17 /Applications/MAMP/htdocs/laravel-nagoyameshi/app/Http/Middleware/RedirectIfAuthenticated.php(31): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#18 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): App\Http\Middleware\RedirectIfAuthenticated->handle(Object(Illuminate\Http\Request), Object(Closure), 'admin')
#19 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(50): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#20 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Routing\Middleware\SubstituteBindings->handle(Object(Illuminate\Http\Request), Object(Closure))
#21 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(57): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Auth\Middleware\Authenticate->handle(Object(Illuminate\Http\Request), Object(Closure))
#23 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(78): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle(Object(Illuminate\Http\Request), Object(Closure))
#25 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\View\Middleware\ShareErrorsFromSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#27 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest(Object(Illuminate\Http\Request), Object(Illuminate\Session\Store), Object(Closure))
#29 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Session\Middleware\StartSession->handle(Object(Illuminate\Http\Request), Object(Closure))
#30 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle(Object(Illuminate\Http\Request), Object(Closure))
#32 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(67): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#33 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Cookie\Middleware\EncryptCookies->handle(Object(Illuminate\Http\Request), Object(Closure))
#34 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(805): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#36 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(784): Illuminate\Routing\Router->runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#37 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(748): Illuminate\Routing\Router->runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#38 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Routing/Router.php(737): Illuminate\Routing\Router->dispatchToRoute(Object(Illuminate\Http\Request))
#39 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(200): Illuminate\Routing\Router->dispatch(Object(Illuminate\Http\Request))
#40 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(144): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#41 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#43 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle(Object(Illuminate\Http\Request), Object(Closure))
#44 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(40): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle(Object(Illuminate\Http\Request), Object(Closure))
#46 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\TrimStrings->handle(Object(Illuminate\Http\Request), Object(Closure))
#47 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\ValidatePostSize->handle(Object(Illuminate\Http\Request), Object(Closure))
#49 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(99): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#50 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle(Object(Illuminate\Http\Request), Object(Closure))
#51 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#52 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\HandleCors->handle(Object(Illuminate\Http\Request), Object(Closure))
#53 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(39): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(183): Illuminate\Http\Middleware\TrustProxies->handle(Object(Illuminate\Http\Request), Object(Closure))
#55 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(119): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(175): Illuminate\Pipeline\Pipeline->then(Object(Closure))
#57 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(144): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter(Object(Illuminate\Http\Request))
#58 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(585): Illuminate\Foundation\Http\Kernel->handle(Object(Illuminate\Http\Request))
#59 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(465): Illuminate\Foundation\Testing\TestCase->call('DELETE', 'http://localhos...', Array, Array, Array, Array)
#60 /Applications/MAMP/htdocs/laravel-nagoyameshi/tests/Feature/SubscriptionTest.php(277): Illuminate\Foundation\Testing\TestCase->delete('http://localhos...')
#61 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(1188): Tests\Feature\SubscriptionTest->test_free_user_cannot_access_subscription_destroy()
#62 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php(61): PHPUnit\Framework\TestCase->runTest()
#63 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(687): Illuminate\Foundation\Testing\TestCase->runTest()
#64 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestRunner.php(106): PHPUnit\Framework\TestCase->runBare()
#65 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestCase.php(517): PHPUnit\Framework\TestRunner->run(Object(Tests\Feature\SubscriptionTest))
#66 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/Framework/TestSuite.php(380): PHPUnit\Framework\TestCase->run()
#67 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#68 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/src/TextUI/Application.php(202): PHPUnit\TextUI\TestRunner->run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#69 /Applications/MAMP/htdocs/laravel-nagoyameshi/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run(Array)
#70 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S02]: Base table or view not found: 1146 Table 'laravel_nagoyameshi_test.subscriptions' doesn't exist (Connection: mysql, SQL: select * from `subscriptions` where `subscriptions`.`user_id` = 35 and `subscriptions`.`user_id` is not null order by `created_at` desc)

  at tests/Feature/SubscriptionTest.php:279
    275â–•          $user = User::factory()->create();
    276â–• 
    277â–•          $response = $this->actingAs($user)->delete(route('subscription.destroy'));
    278â–• 
  âžœ 279â–•          $response->assertRedirect(route('subscription.create'));
    280â–•      }
    281â–• 
    282â–•      // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®æœ‰æ–™ä¼šå“¡ã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ã‚’è§£ç´„ã§ãã‚‹
    283â–•      public function test_premium_user_can_access_subscription_destroy()

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTest > premium user canâ€¦  QueryException   
  SQLSTATE[42S22]: Column not found: 1054 Unknown column 'stripe_id' in 'field list' (Connection: mysql, SQL: update `users` set `stripe_id` = cus_R6W61LsxMEIHeJ, `users`.`updated_at` = 2024-10-27 08:07:12 where `id` = 36)

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:829
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–• 
  âžœ 829â–•             throw new QueryException(
    830â–•                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    831â–•             );
    832â–•         }
    833â–•     }

      [2m+15 vendor frames [22m
  16  tests/Feature/SubscriptionTest.php:286

  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
   FAILED  Tests\Feature\SubscriptionTesâ€¦  UniqueConstraintViolationException   
  SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'admin@example.com' for key 'admins_email_unique' (Connection: mysql, SQL: insert into `admins` (`email`, `password`, `updated_at`, `created_at`) values (admin@example.com, $2y$04$4HQN3a1ieLV0rJ25JICeburTZuv3XZ47CMG.1maNpUo8vBnP.LL7i, 2024-10-27 08:07:12, 2024-10-27 08:07:12))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:824
    820â–•         // message to include the bindings with SQL, which will make this exception a
    821â–•         // lot more helpful to the developer instead of just the database's errors.
    822â–•         catch (Exception $e) {
    823â–•             if ($this->isUniqueConstraintError($e)) {
  âžœ 824â–•                 throw new UniqueConstraintViolationException(
    825â–•                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    826â–•                 );
    827â–•             }
    828â–•

      [2m+12 vendor frames [22m
  13  tests/Feature/SubscriptionTest.php:302


  Tests:    18 failed, 6 passed (18 assertions)
  Duration: 4.88s

